<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Color Code </title>
        <link href ="TestCSS.css" rel="stylesheet"/>
    </head>
    <body>
        <h1 id = "Title"> Color Code </h1>
        <button id="button" onClick="disappear()">Start</button>
        <p id ="countdown"> </p>
        <script>
            var countNum;
            var coloredSquares = ["http://piq.codeus.net/static/media/userpics/piq_307148.png",
                                  "http://piq.codeus.net/static/media/userpics/piq_307149.png", 
                                  "http://piq.codeus.net/static/media/userpics/piq_307153.png",
                                  "http://piq.codeus.net/static/media/userpics/piq_307156.png",
                                  "http://piq.codeus.net/static/media/userpics/piq_307157.png",
                                  "http://piq.codeus.net/static/media/userpics/piq_307151.png"];
            var colors = ["#fe0000", "#ff7701", "#007fff", "#7f00ff", "#ff00fe", "#55ff00" ];
            var threeWords = ["CAT", "DOG", "MUG", "BOY", "BYE", "BOY",
                              "TRY", "PUG", "DAY", "HOP", "RED", "FOG", "DUG", "ZAP", "FOX", "BOX", "FAX"];
            var currentSquare = [];
            var currentColor = [];
            var emptySquares = [];
            var letters = [];
            var randomSquares = [];
            var randomColors = [];
            var userGuesses = [];
            var randomLetters = [];
            var currentGuess = null;
            var guessing = false;
            var scoreP;
            var scoreDiv;
            var letterDiv;
            var checkDiv;
            var scoreText = document.createTextNode("Score: 0");
            var score = 0;
            window.onload=function(){
                var countdown = document.getElementById("countdown");
                countdown.style.display="none";
                countNum = 4;
                document.addEventListener("keydown", keyPressed);            
            };
            
            function disappear(){
                var title = document.getElementById("Title");
                var onClick = document.getElementById("button");
                title.style.display="none";
                onClick.style.display="none";
                countDown();
            }
   
            function countDown(){
                if(countNum === 1)
                    startGame();
                else{
                    var countdown = document.getElementById("countdown");
                    countdown.style.display="block";
                    countNum--;
                    countdown.innerHTML = countNum;
                    setTimeout(countDown, 1000);
                }
            }
            
            function startGame(){
                var countdown = document.getElementById("countdown");
                countdown.style.display="none";
                var imgDiv = document.createElement("div");
                imgDiv.style.height = "200px";
                imgDiv.style.lineHeight = "200px";
                imgDiv.style.transform = "translateY(+120%)";
                imgDiv.style.textAlign = "center";
                imgDiv.style.zIndex = "1";
                document.body.appendChild(imgDiv);
                for(var i = 0; i < 3; i++){
                    var emptySquare = document.createElement("img");
                    var index = Math.floor((Math.random()*6)+0);
                    var colorLink = coloredSquares[index];
                    containsValue(colorLink);
                    emptySquare.src = "http://piq.codeus.net/static/media/userpics/piq_307159.png";
                    emptySquare.style.verticalAlign = "middle";
                    emptySquare.style.paddingLeft = "20px";
                    emptySquare.style.paddingRight = "20px";
                    emptySquares.push(emptySquare);
                    imgDiv.appendChild(emptySquare);
                }
                letterDiv = document.createElement("div");
                letterDiv.style.position = "relative";
                letterDiv.style.height = "200px";
                letterDiv.style.lineHeight = "200px";
                letterDiv.style.transform = "translateY(+16%)";
                letterDiv.style.textAlign = "center";
                var string = threeWords[Math.floor((Math.random()*16)+0)];
                for(var i = 0; i < 3; i++){
                    var letter = document.createElement("p");
                    var c = document.createTextNode(string.charAt(i));
                    letter.style.verticalAlign = "middle";
                    letter.style.display = "inline-block";
                    letter.style.paddingLeft = "52px";
                    letter.style.paddingRight = "52px";
                    letter.style.color = currentColor[i];
                    letter.style.font = "68px Impact";
                    letter.appendChild(c);
                    letters.push(letter);
                    letterDiv.appendChild(letter);
                }
                letterDiv.style.zIndex = "2";
                document.body.appendChild(letterDiv);
                scoreDiv = document.createElement("div");
                scoreDiv.style.position = "relative";
                scoreDiv.style.height = "200px";
                scoreDiv.style.lineHeight = "200px";
                scoreDiv.style.transform = "translateY(-225%)";
                scoreDiv.style.textAlign = "center";
                scoreDiv.style.zIndex = "3";
                scoreP = document.createElement("p");
                scoreP.appendChild(scoreText);
                scoreP.style.font = "80px Impact";
                scoreP.style.textAlign = "center";
                scoreP.style.verticalAlign = "middle";
                scoreDiv.appendChild(scoreP);
                document.body.appendChild(scoreDiv);
                setTimeout(userGuess, 1000);
            }
            
            function containsValue(value){
                if(currentSquare.indexOf(value) === -1){
                    currentSquare.push(value);
                    currentColor.push(colors[coloredSquares.indexOf(value)]);
                    return;
                }
                else{
                    var newValue = coloredSquares[Math.floor((Math.random()*6)+0)];
                    containsValue(newValue);
                    return;
                }
            }
            
            function userGuess(){
                for(var i = 0; i < 3; i++){
                    letters[i].style.color = "black";
                    setRandomOrder(currentSquare[Math.floor((Math.random()*3)+0)]);
                    emptySquares[i].src = randomSquares[i];
                }
                for(var i = 0; i < letters.length; i++){
                    letters[i].innerHTML = "_";
                }
                guessing = true;
            }
            
            function keyPressed(evt){
                if(evt.keyCode >= 65 && evt.keyCode <= 90 && guessing){
                    currentGuess = (String.fromCharCode(evt.keyCode));
                    letters[userGuesses.length].innerHTML = currentGuess;
                }
                
                else if(evt.keyCode === 13 && guessing){
                    if(currentGuess !== null){
                        userGuesses.push(currentGuess);
                        currentGuess = null;
                        if(userGuesses.length === 3){
                            checkEquality();
                        }
                    }
                }
            }
            
            function checkEquality(){
                guessing = false;
                var equal = true;
                checkDiv = document.createElement("div");
                checkDiv.style.position = "relative";
                checkDiv.style.height = "200px";
                checkDiv.style.lineHeight = "200px";
                checkDiv.style.transform = "translateY(-265%)";
                checkDiv.style.textAlign = "center";
                checkDiv.style.zIndex = "4";
                document.body.appendChild(checkDiv);
                for(var i = 0; i < userGuesses.length; i++){
                    if(userGuesses[i] !== randomLetters[i]){
                        equal = false;
                        emptySquares[i].src = "http://piq.codeus.net/static/media/userpics/piq_307148.png";
                    }
                    else{
                        emptySquares[i].src = "http://piq.codeus.net/static/media/userpics/piq_307151.png";
                        score = score + 10;
                    }
                }
                
                if(equal){
                    var check = document.createElement("img");
                    check.src = "http://www.clker.com/cliparts/R/C/5/I/G/P/green-light-tick-mark-th.png";
                    checkDiv.appendChild(check);
                }
                else{
                    var x = document.createElement("img");
                    x.src = "http://www.clker.com/cliparts/1/1/9/2/12065738771352376078Arnoud999_Right_or_wrong_5.svg.thumb.png";
                    checkDiv.appendChild(x);
                }
                scoreP.innerHTML = "Score: " + score; 
            }
            
            function setRandomOrder(value){
                if(randomSquares.indexOf(value) === -1){
                    randomSquares.push(value);
                    randomColors.push(currentColor[currentSquare.indexOf(value)]);
                    randomLetters.push(letters[currentSquare.indexOf(value)].innerHTML);
                    return;
                }
                else{
                    var newValue = currentSquare[Math.floor((Math.random()*3)+0)];
                    setRandomOrder(newValue);
                    return;
                }
            }

        </script>
    </body>
</html>
